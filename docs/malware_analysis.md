---
tags:
  - Analysis
  - Malware
---
Analyzing [malware](malware.md), or malicious software, is more of an art than
a technique. Because of the wide nature of these products, there are limitless
ways to hide functionality

Some common tools for malware analysis include simple programs like
[strings](strings.md). More complex analysis can be conducted by looking at the
headers of executables with programs like [PEiD](peid.md) and PeExplorer.
Finally, the most complete analysis can be done with debuggers like
[IDA Pro](ida_pro.md) and OllyDbg.

## Malware techniques

### Process hollowing

Process hollowing is yet another tool in the kit of those who seek to
hide the presence of a process. The idea is rather straight forward: a
bootstrap application creates a seemingly innocent process in a
suspended state. The legitimate image is then unmapped and replaced with
the image that is to be hidden. If the preferred image base of the new
image does not match that of the old image, the new image must be
rebased. Once the new image is loaded in memory the EAX register of the
suspended thread is set to the entry point. The process is then resumed
and the entry point of the new image is executed.
[1](http://www.autosectools.com/Process-Hollowing.pdf)

## See Also

- [Malware](malware.md)
- [List of Malware Analysis
  Tools](list_of_malware_analysis_tools.md)

## External Links

- [Executable File Analysis (Windows Forensic Analysis) Part
  1](http://what-when-how.com/windows-forensic-analysis/executable-file-analysis-windows-forensic-analysis-part-1/)
- [Executable File Analysis (Windows Forensic Analysis) Part
  2](http://what-when-how.com/windows-forensic-analysis/executable-file-analysis-windows-forensic-analysis-part-2/)
- [Executable File Analysis (Windows Forensic Analysis) Part
  3](http://what-when-how.com/windows-forensic-analysis/executable-file-analysis-windows-forensic-analysis-part-3/)
- [Executable File Analysis (Windows Forensic Analysis) Part
  4](http://what-when-how.com/windows-forensic-analysis/executable-file-analysis-windows-forensic-analysis-part-4/)
- [Exploiting the Microsoft Windows
  TaskScheduler‘.job’StackOverflowVulnerability](http://www.giac.org/paper/gcih/641/exploiting-microsoftwindows-task-scheduler-job-stack-overflow-vulnerability/104732),
  by Kevin Wenchel, May 2004
- [De Mysteriis Dom Jobsivs: Mac EFI
  Rootkits](http://ho.ax/downloads/De_Mysteriis_Dom_Jobsivs_Ruxcon.pdf),
  by Snare, October 2012
- [Anatomy of an exploit - inside the CVE-2013-3893 Internet Explorer
  zero-day - Part
  1](http://nakedsecurity.sophos.com/2013/10/11/anatomy-of-an-exploit-ie-zero-day-part-1/),
  by Paul Ducklin on October 11, 2013
- [Anatomy of an exploit - inside the CVE-2013-3893 Internet Explorer
  zero-day - Part
  2](http://nakedsecurity.sophos.com/2013/10/25/anatomy-of-an-exploit-inside-the-cve-2013-3893-internet-explorer-zero-day-part-2/),
  by Paul Ducklin on October 25, 2013
- [Security Tip (ST13-003) - Handling Destructive
  Malware](https://www.us-cert.gov/ncas/tips/ST13-003), by US-CERT,
  November 04, 2013
- [Detecting Malware With Memory
  Forensics](http://www.deer-run.com/~hal/Detect_Malware_w_Memory_Forensics.pdf),
  by [Hal Pomeranz](hal_pomeranz.md)
- [Mac OS X Live Forensics 107: Mac
  Malware](http://lockboxx.blogspot.com/2014/11/mac-os-x-live-forensics-107-mac-malware.html?m=1),
  by Action Dan, November 3, 2014
- [The not so boring land of Borland executables, part
  1](http://www.hexacorn.com/blog/2014/12/05/the-not-so-boring-land-of-borland-executables-part-1/),
  Hexacorn blog, December 5, 2014
- [The not so boring land of Borland executables, part
  2](http://www.hexacorn.com/blog/2014/12/18/the-not-so-boring-land-of-borland-executables-part-2/),
  Hexacorn blog, December 18, 2014
- [RSA Incident Response: An APT Case
  Study](https://blogs.rsa.com/wp-content/uploads/2015/05/RSA-IR-Case-Study.pdf),
  by RSA Security, April 8, 2015
- [Ghosts in the
  endpoint](https://www.fireeye.com/blog/threat-research/2016/04/ghosts_in_the_endpoi.html)
  by Daniel Regalado, Erye Hernandez, Taha Karim, Varun Jain, April 13,
  2016
- [Microsoft Office Exploit Analysis –
  CVE-2015-1641](http://www.sekoia.fr/blog/ms-office-exploit-analysis-cve-2015-1641/),
  April 12, 2016

### Analysis techniques and tools

#### Remnux

- [Dynamic malware analysis with Remnux v5 – part
  1](http://countuponsecurity.com/2015/01/13/dynamic-malware-analysis-with-remnux-v5-part-1/),
  by Luis Rocha, January 13, 2015
- [Dynamic malware analysis with Remnux v5 – part
  1](http://countuponsecurity.com/2015/01/21/dynamic-malware-analysis-with-remnux-v5-part-2/),
  by Luis Rocha, January 21, 2015

### Malware techniques

- [Windows Kernel Exploitation
  Humla](http://null.co.in/2015/05/07/windows-kernel-exploitation-hacksys-extreme-vulnerable-driver/),
  by Ashfaq Ansari, May 7, 2015

#### Code injection

- [Injection on Steroids: Code-less Code Injections and 0-Day
  Techniques](http://breakingmalware.com/injection-techniques/code-less-code-injections-and-0-day-techniques/),
  by Tomer Bitton, August 13, 2015
- [PowerLoaderEx - Advanced Code Injection Technique for x32 /
  x64](https://github.com/BreakingMalware/PowerLoaderEx)

#### Reflective DLL injection

- [Reflective DLL
  Injection](http://www.harmonysecurity.com/files/HS-P005_ReflectiveDllInjection.pdf),
  by Stephen Fewer, October 31, 2008

#### Process hollowing

- [Process
  Hollowing](http://www.autosectools.com/Process-Hollowing.pdf), by John
  Leitch

#### WMI

- [SprayWMI is an easy way to get mass shells on systems that support
  WMI](https://github.com/trustedsec/spraywmi)

### Malware analysis

- [Malware don't need Coffee](http://malware.dontneedcoffee.com/)

#### APT28

- [Operation RussianDoll: Adobe & Windows Zero-Day Exploits Likely
  Leveraged by Russia’s APT28 in Highly-Targeted
  Attack](https://www.fireeye.com/blog/threat-research/2015/04/probable_apt28_useo.html),
  by Fireeye Labs, April 18, 2015

#### Black POS

- [Point-of-Sale System
  Breaches](http://www.trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-pos-system-breaches.pdf),
  by Trend Micro
- [New BlackPOS Malware Emerges in the Wild, Targets Retail
  Accounts](http://blog.trendmicro.com/trendlabs-security-intelligence/new-blackpos-malware-emerges-in-the-wild-targets-retail-accounts/),
  by Rhena Inocencio, August 29, 2014
- [BlackPOS v2: New Variant or Different
  Family?](http://blog.nuix.com/2014/09/08/blackpos-v2-new-variant-or-different-family),
  by Josh Grunzweig, September 8, 2014

#### Careto

- [Unveiling "Careto" - The Masked
  APT](http://www.securelist.com/en/downloads/vlpdfs/unveilingthemask_v1.0.pdf),
  by [Kaspersky Lab](kaspersky.md), February 2014

#### China Chopper

- [Breaking Down the China Chopper Web Shell – Part
  I](http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html),
  by Tony Lee, Ian Ahl and Dennis Hanzlik, August 7, 2013
- [Breaking Down the China Chopper Web Shell – Part
  2](http://www.fireeye.com/blog/technical/botnet-activities-research/2013/08/breaking-down-the-china-chopper-web-shell-part-ii.html),
  by Tony Lee, Ian Ahl and Dennis Hanzlik, August 9, 2013

#### Gh0st Rat

- [The many faces of Gh0st Rat - Plotting the connections between
  malware
  attacks](http://download01.norman.no/documents/ThemanyfacesofGh0stRat.pdf)
  by Snorre Fagerland, 2012

#### Dark Hotel

- [The Darkhotel
  APT](http://securelist.com/blog/research/66779/the-darkhotel-apt/), by
  Kaspersky Lab Research, November, 2014

#### Dridex

- [My analysis of Dridex malware (Part
  One)](https://jon.glass/analyzes-dridex-malware-p1/), by Jonathan
  Glass, March 20, 2015
- [My analysis of Dridex malware (Part
  Two)](https://jon.glass/analyzes-dridex-malware-p2/), by Jonathan
  Glass, March 23, 2015

#### Equation group

- [How “omnipotent” hackers tied to NSA hid for 14 years—and were found
  at
  last](http://arstechnica.com/security/2015/02/how-omnipotent-hackers-tied-to-the-nsa-hid-for-14-years-and-were-found-at-last/),
  by Dan Goodin, Feb 16, 2015

#### FinFisher

- [FinFisher Malware Dropper
  Analysis](https://www.codeandsec.com/FinFisher-Malware-Dropper-Analysis),
  by CodeAndSec, September 19, 2014

#### Hacking Team

- [Police Story: Hacking Team’s Government Surveillance
  Malware](https://citizenlab.org/2014/06/backdoor-hacking-teams-tradecraft-android-implant/),
  by Morgan Marquis-Boire, John Scott-Railton, Claudio Guarnieri, and
  Katie Kleemola, June 24, 2014
- [HackingTeam 2.0: The Story Goes
  Mobile](http://www.securelist.com/en/blog/8231/HackingTeam_2_0_The_Story_Goes_Mobile),
  Kaspersky Lab, June 24, 2014
- [Shakacon \#6 presentation: Fuck you Hacking Team, From Portugal with
  Love](http://reverse.put.as/2014/06/26/shakacon-6-presentation-fuck-you-hacking-team-from-portugal-with-love/),
  by fG!, June 26 2014

#### Hikit

- [The "Hikit" Rootkit: Advanced and Persistent Attack Techniques (Part
  1)](https://www.mandiant.com/blog/hikit-rootkit-advanced-persistent-attack-techniques-part-1-2/),
  by Ryan Kazanciyan, August 20, 2012
- [The "Hikit" Rootkit: Advanced and Persistent Attack Techniques (Part
  2)](https://www.mandiant.com/blog/hikit-rootkit-advanced-persistent-attack-techniques-part-2/),
  by Christopher Glyer, August 22, 2012

#### Icefog

- [The ‘icefog’ APT: A tale of cloak and three
  daggers](https://www.securelist.com/en/downloads/vlpdfs/icefog.pdf),
  by Kaspersky Lab, September 2013

#### Kriptovor

- [Analysis of KRIPTOVOR:
  Infostealer+Ransomware](https://www.fireeye.com/blog/threat-research/2015/04/analysis_of_kriptovo.html),
  by Erye Hernandez, April 08, 2015

#### LeoUncia, OrcaRat

- [LeoUncia and
  OrcaRat](http://blog.airbuscybersecurity.com/post/2014/10/LeoUncia-and-OrcaRat),
  by Jérémy Richard, October 24, 2014

#### PlugX

- [An Analysis of PlugX](http://labs.lastline.com/an-analysis-of-plugx),
  by Roman Vasilenko, December 17, 2013
- [I Know You Want Me - Unplugging
  PlugX](https://www.blackhat.com/docs/asia-14/materials/Haruyama/Asia-14-Haruyama-I-Know-You-Want-Me-Unplugging-PlugX.pdf),
  by Takahiro Haruyama and Hiroshi Suzuki, BlackHat Asia 2014

#### Regin

- [Malware Instrumentation Application to Regin
  Analysis](http://artemonsecurity.com/regin_analysis.pdf), by tecamac,
  May 27, 2015

#### Riptide, Hightide, Threebyte, Watersprout

- [Trends Beyond the
  Breach](https://dl.mandiant.com/EE/library/WP_M-Trends2014_140409.pdf),
  by Mandiant, 2014
- [Illuminating the Etumbot APT
  Backdoor](http://www.arbornetworks.com/asert/wp-content/uploads/2014/06/ASERT-Threat-Intelligence-Brief-2014-07-Illuminating-Etumbot-APT.pdf),
  by Arbor Networks, June 6, 2014
- [Darwin’s Favorite APT
  Group](http://www.fireeye.com/blog/technical/botnet-activities-research/2014/09/darwins-favorite-apt-group-2.html),
  by Ned Moran, Mike Oppenheim, Sarah Engle and Richard Wartell,
  September 3, 2014

#### Rombertik

- [Threat Spotlight: Rombertik – Gazing Past the Smoke, Mirrors, and
  Trapdoors](http://blogs.cisco.com/security/talos/rombertik), by Talos
  Group, May 4, 2015

#### Sednit

- [Sednit espionage group now using custom exploit
  kit](http://www.welivesecurity.com/2014/10/08/sednit-espionage-group-now-using-custom-exploit-kit/),
  by ESET research, October 8, 2014

#### Shell Crew

- [RSA Incident Response: Emerging Threat Profile -
  Shell_Crew](http://www.emc.com/collateral/white-papers/h12756-wp-shell-crew.pdf),
  by [EMC](emc.md), January 2014

#### Uroburos

- [Uroburos - Highly complex espionage software with Russian
  roots](https://public.gdatasoftware.com/Web/Content/INT/Blog/2014/02_2014/documents/GData_Uroburos_RedPaper_EN_v1.pdf),
  by G Data SecurityLabs, February 2014
- [Uroburos: the snake
  rootkit](http://artemonsecurity.com/uroburos.pdf), by deresz, tecamac,
  March 12, 2014
- [Uroburos Rootkit Hook Analysis and Driver
  Extraction](http://spresec.blogspot.com/2014/03/uroburos-rootkit-hook-analysis-and.html?m=1),
  SP Security Blog, March 20, 2014

#### Winnti

- ["Winnti" More than just a
  game](https://www.securelist.com/en/downloads/vlpdfs/winnti-more-than-just-a-game-130410.pdf),
  by Kaspersky Lab, April 2013

#### Wiper

- [Wiper family of malware targeting Sony Pictures
  grows](http://blog.cyren.com/articles/wiper-family-of-malware-grows.html),
  by Rommel Ramos, December 10, 2014

#### WireLurker

- [WIRELURKER: A New Era in iOS and OS X
  Malware](https://www.paloaltonetworks.com/content/dam/paloaltonetworks-com/en_US/assets/pdf/reports/Unit_42/unit42-wirelurker.pdf),
  by Palo Alto Networks

#### Sources

- [lizkebab](https://github.com/pop-pop-ret/lizkebab)
